# HolidayBot

Небольшой бот на aiogram, который поможет разбавить ваш чат ежедневными праздниками с calend.ru:

- кэширует данные с calend.ru один раз в день в 23:50 МСК (сразу берёт праздники на завтра);
- хранит данные в `HolidayBot/data/holidays.json`;
- автоматически отправляет дайджест праздников в заданный момент (по умолчанию 00:00 МСК);
- позволяет посмотреть праздники вручную через `/holidays`;
- даёт администраторам целевого чата менять время автопубликации командой `/holidaystime 08:30`.

## Быстрый старт

1. Настройте `HolidayBot/config/settings.json` (при необходимости можно скопировать `settings.json.example`) и заполните:
   - `token` — токен Telegram-бота;
   - `target_chat_id` — ID целевого чата/канала;
   - `holidays_cache_path` — путь до JSON-кэша (по умолчанию `HolidayBot/data/holidays.json`);
   - `holidays_autopost_time` — время автопубликации в формате `ЧЧ:ММ`;
   - `admin_user_ids` — массив ID пользователей, которым всегда разрешено менять время.
2. Установите зависимости из корневого `requirements.txt` или создайте собственное окружение.
3. Запустите HolidayBot:

```bash
python bot.py
```

Во время запуска бот загружает существующий кэш, обновляет его при необходимости и запускает две фоновые задачи:

- обновление кэша в 23:50 МСК;
- автопубликацию в заданное время по московскому времени.

## Команды

- `/start` — приветственное сообщение;
- `/holidays` — выводит дайджест праздников из кэша (работает в настроенном чате);
- `/holidaystime [ЧЧ:ММ]` — показывает или изменяет время автопубликации (только для админов).
- `/chatid` — отправляет ID текущего чата (удобно, если нужно заполнить `settings.json`).


